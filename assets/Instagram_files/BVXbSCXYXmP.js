;/*FB_PKG_DELIM*/

__d("BotFeedbackKind",[],(function(a,b,c,d,e,f){a=Object.freeze({BOT_FEEDBACK_POSITIVE:0,BOT_FEEDBACK_NEGATIVE_GENERIC:1,BOT_FEEDBACK_NEGATIVE_HELPFUL:2,BOT_FEEDBACK_NEGATIVE_INTERESTING:3,BOT_FEEDBACK_NEGATIVE_ACCURATE:4,BOT_FEEDBACK_NEGATIVE_SAFE:5,BOT_FEEDBACK_NEGATIVE_OTHER:6,BOT_FEEDBACK_NEGATIVE_REFUSED:7,BOT_FEEDBACK_NEGATIVE_NOT_VISUALLY_APPEALING:8,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_TEXT:9,BOT_FEEDBACK_NEGATIVE_PERSONALIZED:10,BOT_FEEDBACK_NEGATIVE_CLARITY:11,BOT_FEEDBACK_NEGATIVE_DOESNT_LOOK_LIKE_THE_PERSON:12,BOT_FEEDBACK_NEGATIVE_HALLUCINATION_INTERNAL_ONLY:13,BOT_FEEDBACK_NEGATIVE:14,BOT_FEEDBACK_NEGATIVE_DONT_SHOW_AGAIN:15,BOT_FEEDBACK_NEGATIVE_INCORRECT_OWNERSHIP:16,BOT_FEEDBACK_NEGATIVE_NOT_RELEVANT_TO_RESPONSE:17,BOT_FEEDBACK_NEGATIVE_TOO_REPETITIVE:18});f["default"]=a}),66);
__d("EmojiFormat.bs",[],(function(a,b,c,d,e,f){"use strict";function g(a){return a.split("_").map(function(a){return parseInt(a,16)})}function a(a){return a.map(function(a){return a.toString(16)}).join("_")}function h(a){return a.map(function(a){return String.fromCodePoint(a)}).join("")}function b(a){return h(g(a))}f.codeStringToCodeArray=g;f.codeArrayToCodeString=a;f.codeArrayToUnicode=h;f.codeStringToUnicode=b}),66);
__d("GetPreviewDimension",["Promise"],(function(a,b,c,d,e,f){"use strict";var g;function a(a){return new(g||(g=b("Promise")))(function(b){var c=new Image();c.onload=function(){return b({previewHeight:c.height,previewWidth:c.width})};c.onerror=function(){return b()};c.src=a})}function c(a){return new(g||(g=b("Promise")))(function(b){var c=document.createElement("video");c.onloadedmetadata=function(){return b({previewHeight:c.videoHeight,previewWidth:c.videoWidth})};c.onerror=function(){return b()};c.src=a})}f.getPreviewDimensions=a;f.getVideoPreviewDimensions=c}),66);
__d("IGDSErrorOutlineIcon.react",["IGDSErrorPanoOutlineIcon.react","react","react-compiler-runtime"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react");function a(a){var b=d("react-compiler-runtime").c(2),e;b[0]!==a?(e=i.jsx(c("IGDSErrorPanoOutlineIcon.react"),babelHelpers["extends"]({},a)),b[0]=a,b[1]=e):e=b[1];return e}b=i.memo(a);g["default"]=b}),98);
__d("LSDeleteReaction",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.filter(b.db.table(8).fetch([[[a[0],a[1],a[2]]]]),function(c){return b.i64.eq(c.threadKey,a[0])&&c.messageId===a[1]&&b.i64.eq(c.actorId,a[2])&&b.i64.eq(b.i64.cast([0,0]),b.i64.cast([0,0]))}),function(a){return a["delete"]()})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxDeleteReactionStoredProcedure";a.__tables__=["reactions"];e.exports=a}),null);
__d("LSOptimisticUpsertReaction",["LSCancelTaskByQueueName","LSDeleteReaction","LSIssueNewTask","LSUpsertReaction"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[0]=c.i64.cast([0,1]):(b=a.item,d[21]=b.syncGroup,c.i64.neq(d[21],void 0)?d[20]=d[21]:d[20]=c.i64.cast([0,1]),d[0]=d[20])})},function(e){return d[2]=new c.Map(),d[2].set("thread_key",a[0]),d[2].set("timestamp_ms",a[1]),d[2].set("message_id",a[2]),d[2].set("actor_id",a[3]),d[2].set("reaction",a[4]),d[2].set("reaction_style",void 0),d[2].set("sync_group",d[0]),d[3]=c.createArray(),d[4]=(d[3].push("reaction"),d[3]),d[5]=d[2].get("message_id"),d[6]=(d[3].push(d[5]),d[3]),d[7]=c.toJSON(d[3]),c.storedProcedure(b("LSCancelTaskByQueueName"),d[7],c.i64.cast([0,29]))},function(e){return a[4]===""?c.sequence([function(d){return c.storedProcedure(b("LSDeleteReaction"),a[0],a[2],a[3])},function(a){return d[8]=void 0}]):c.sequence([function(e){return a[4]==="\u2764\ufe0f"||a[4]==="\u2764\ufe0f"?d[20]="\u2764":d[20]=a[4],c.storedProcedure(b("LSUpsertReaction"),a[0],a[1],a[2],a[3],d[20],c.i64.cast([0,20]),void 0)},function(a){return d[8]=void 0}])},function(b){return void 0?d[9]=!1:d[9]=!0,d[9]?d[10]=void 0:(d[20]=new c.Map(),d[20].set("feature_tags",void 0),d[21]=new c.Map(),d[21].set("logging_metadata",d[20]),d[22]=c.toJSON(d[21]),d[10]=d[22]),c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[11]=c.i64.cast([0,1]):(b=a.item,d[21]=b.syncGroup,c.i64.neq(d[21],void 0)?d[20]=d[21]:d[20]=c.i64.cast([0,1]),d[11]=d[20])})},function(e){return d[13]=new c.Map(),d[13].set("thread_key",a[0]),d[13].set("timestamp_ms",a[1]),d[13].set("message_id",a[2]),d[13].set("actor_id",a[3]),d[13].set("reaction",a[4]),d[13].set("reaction_style",void 0),d[13].set("sync_group",d[11]),d[13].set("send_attribution",a[5]),d[13].set("dataclass_params",d[10]),d[13].set("attachment_fbid",void 0),d[14]=c.createArray(),d[15]=(d[14].push("reaction"),d[14]),d[16]=d[13].get("message_id"),d[17]=(d[14].push(d[16]),d[14]),d[18]=c.toJSON(d[14]),d[19]=c.toJSON(d[13]),c.storedProcedure(b("LSIssueNewTask"),d[18],c.i64.cast([0,29]),d[19],void 0,void 0,a[6]==null?c.i64.cast([0,0]):a[6],c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticUpsertReactionStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSOptimisticUpsertReactionStoredProcedure",["LSOptimisticUpsertReaction","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticUpsertReaction"),e.threadKey,e.timestampMs,e.messageId,e.actorId,e.reaction,e.sendAttribution,e.pluginType);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSUpdateOrInsertReactionV2",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[],d=[];return b.sequence([function(d){return b.db.table(226).fetch([[[a[0],a[1],a[2]]]]).next().then(function(d,e){var f=d.done;d=d.value;return f?b.db.table(12).fetch([[[a[1]]],"messageId"]).next().then(function(d,e){var c=d.done;d=d.value;return c?0:(e=d.item,b.sequence([function(c){return b.forEach(b.filter(b.db.table(226).fetch([[[a[0],a[1],a[2]]],"optimistic"]),function(c){return b.i64.eq(c.threadKey,a[0])&&c.messageId===a[1]&&b.i64.eq(c.reactionFbid,a[2])&&b.i64.lt(c.authorityLevel,a[5])}),function(a){return a["delete"]()})},function(c){return b.db.table(226).add({messageId:a[1],threadKey:a[0],reactionFbid:a[2],messageTimestamp:e.timestampMs,authorityLevel:a[5],count:a[4],viewerIsReactor:a[6],viewerReactionTimestampMs:a[7],lastUpdatedTimestampMs:a[8]})}]))}):(e=d.item,c[2]=e.lastUpdatedTimestampMs,c[1]=e.authorityLevel,b.i64.eq(a[5],b.i64.cast([0,20]))||b.i64.eq(c[1],b.i64.cast([0,80]))&&b.i64.eq(a[5],b.i64.cast([0,80]))||b.i64.eq(c[1],b.i64.cast([0,20]))&&b.i64.eq(a[5],b.i64.cast([0,80]))&&b.i64.le(b.i64.add(c[2],b.i64.cast([0,2e3])),a[8])||b.i64.eq(c[1],b.i64.cast([0,20]))&&b.i64.eq(a[5],b.i64.cast([0,60]))||b.i64.eq(c[1],b.i64.cast([0,60]))&&b.i64.eq(a[5],b.i64.cast([0,80]))&&b.i64.le(c[2],a[8])?c[3]=!0:c[3]=!1,c[3]?b.db.table(226).put({messageId:a[1],threadKey:a[0],reactionFbid:a[2],messageTimestamp:e.messageTimestamp,reactionLiteral:a[3],count:a[4],authorityLevel:a[5],viewerIsReactor:a[6],viewerReactionTimestampMs:b.i64.cast([0,0]),lastUpdatedTimestampMs:a[8]}):b.resolve())})},function(a){return b.resolve(d)}])}a.__sproc_name__="LSMailboxUpdateOrInsertReactionV2StoredProcedure";a.__tables__=["reactions_v2","messages"];e.exports=a}),null);
__d("LSOptimisticUpsertReactionV2",["LSCancelTaskByQueueName","LSDeleteReaction","LSIssueNewTaskWithExtraOperations","LSUpdateOrInsertReactionV2","LSUpsertReaction"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(e){return c.i64.eq(a[8],c.i64.cast([0,2]))?c.sequence([function(b){return c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[16]=c.i64.cast([0,1]):(b=a.item,d[25]=b.syncGroup,c.i64.neq(d[25],void 0)?d[24]=d[25]:d[24]=c.i64.cast([0,1]),d[16]=d[24])})},function(e){return d[18]=new c.Map(),d[18].set("thread_id",a[1]),d[18].set("message_id",a[2]),d[18].set("message_timestamp",a[3]),d[18].set("actor_id",a[0]),d[18].set("reaction_fbid",a[4]),d[18].set("reaction_style",a[7]),d[18].set("operation",a[8]),d[18].set("viewer_is_reactor",a[6]),d[18].set("current_count",a[5]),d[18].set("reaction_literal",a[9]),d[18].set("sync_group",d[16]),d[19]=c.createArray(),d[20]=(d[19].push("reaction_v2"),d[19]),d[21]=d[18].get("message_id"),d[22]=(d[19].push(d[21]),d[19]),d[23]=c.toJSON(d[19]),c.storedProcedure(b("LSCancelTaskByQueueName"),d[23],c.i64.cast([0,604]))}]):c.resolve()},function(e){return[c.i64.cast([0,2]),c.i64.cast([0,3])].some(function(b){return c.i64.eq(a[8],b)})?d[0]=c.i64.add(a[5],c.i64.cast([-1,4294967295])):d[0]=c.i64.add(a[5],c.i64.cast([0,1])),[c.i64.cast([0,2]),c.i64.cast([0,3])].some(function(b){return c.i64.eq(a[8],b)})?d[1]=!1:d[1]=!0,d[2]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSUpdateOrInsertReactionV2"),a[1],a[2],a[4],a[9],d[0],c.i64.cast([0,20]),d[1],c.i64.cast([0,0]),d[2])},function(b){return c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[3]=void 0:(b=a.item,d[3]=b.threadType)})},function(e){return c.i64.neq(d[3],c.i64.cast([0,23]))?[c.i64.cast([0,2]),c.i64.cast([0,3])].some(function(b){return c.i64.eq(a[8],b)})?c.i64.eq(a[8],c.i64.cast([0,2]))?c.storedProcedure(b("LSDeleteReaction"),a[1],a[2],a[0]):c.sequence([function(b){return c.filter(c.db.table(8).fetch([[[a[1],a[2],a[0]]]]),function(b){return c.i64.eq(b.threadKey,a[1])&&b.messageId===a[2]&&c.i64.eq(b.actorId,a[0])&&c.i64.eq(c.i64.cast([0,0]),c.i64.cast([0,0]))}).next().then(function(a,b){var c=a.done;a=a.value;return c?d[16]=void 0:(b=a.item,d[16]=b.reaction)})},function(e){return a[9]!==void 0?(a[9]==="\u2764\ufe0f"||a[9]==="\u2764\ufe0f"?d[18]="\u2764":d[18]=a[9],d[18]===d[16]?c.storedProcedure(b("LSDeleteReaction"),a[1],a[2],a[0]):c.resolve()):c.resolve()}]):a[9]!==void 0?(a[9]==="\u2764\ufe0f"||a[9]==="\u2764\ufe0f"?d[16]="\u2764":d[16]=a[9],d[17]=c.i64.of_float(Date.now()),c.storedProcedure(b("LSUpsertReaction"),a[1],a[3],a[2],a[0],d[16],c.i64.cast([0,20]),d[17])):c.resolve():c.resolve()},function(b){return c.db.table(9).fetch([[[a[1]]]]).next().then(function(a,b){var e=a.done;a=a.value;return e?d[5]=c.i64.cast([0,1]):(b=a.item,d[17]=b.syncGroup,c.i64.neq(d[17],void 0)?d[16]=d[17]:d[16]=c.i64.cast([0,1]),d[5]=d[16])})},function(b){return d[7]=new c.Map(),d[7].set("thread_id",a[1]),d[7].set("message_id",a[2]),d[7].set("message_timestamp",a[3]),d[7].set("actor_id",a[0]),d[7].set("reaction_fbid",a[4]),d[7].set("reaction_style",a[7]),d[7].set("current_count",a[5]),d[7].set("viewer_is_reactor",a[6]),d[7].set("operation",a[8]),d[7].set("reaction_literal",a[9]),d[7].set("entry_point",void 0),d[7].set("sync_group",d[5]),c.db.table(9).fetch([[[a[1]]]]).next().then(function(b,e){var f=b.done;b=b.value;return f?d[8]=!1:(e=b.item,c.sequence([function(b){return c.filter(c.db.table(14).fetch([[[e.threadKey,a[0]]]]),function(b){return c.i64.eq(b.threadKey,e.threadKey)&&c.i64.eq(c.i64.cast([0,0]),e.mailboxType)&&c.i64.eq(b.contactId,a[0])}).next().then(function(b,f){var a=b.done;b=b.value;return a?d[16]=!1:(f=b.item,c.i64.eq(e.threadType,c.i64.cast([0,152]))?(d[19]=f.threadRoles,c.i64.lt(c.i64.cast([0,7]),c.i64.cast([0,0]))||c.i64.gt(c.i64.cast([0,7]),c.i64.cast([0,9]))?d[20]=!1:d[20]=!c.i64.eq(c.i64.and_(c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.cast([0,7]))),d[19]),c.i64.cast([0,0])),d[21]=e.capabilities,d[22]=e.capabilities2,d[23]=e.capabilities3,d[24]=e.capabilities4,d[25]=e.capabilities5,d[27]=c.i64.div(c.i64.cast([0,223]),c.i64.cast([0,64])),d[28]=c.i64.lsl_(c.i64.cast([0,1]),c.i64.to_int32(c.i64.sub(c.i64.cast([0,223]),c.i64.mul(d[27],c.i64.cast([0,64]))))),c.i64.lt(c.i64.cast([0,223]),c.i64.cast([0,0]))||c.i64.gt(c.i64.cast([0,223]),c.i64.cast([0,298]))?d[26]=!1:(c.i64.eq(d[27],c.i64.cast([0,0]))?d[29]=!c.i64.eq(c.i64.and_(d[28],d[21]),c.i64.cast([0,0])):(c.i64.eq(d[27],c.i64.cast([0,1]))?d[30]=!c.i64.eq(c.i64.and_(d[28],d[22]),c.i64.cast([0,0])):(c.i64.eq(d[27],c.i64.cast([0,2]))?d[31]=!c.i64.eq(c.i64.and_(d[28],d[23]),c.i64.cast([0,0])):(c.i64.eq(d[27],c.i64.cast([0,3]))?d[32]=!c.i64.eq(c.i64.and_(d[28],d[24]),c.i64.cast([0,0])):(c.i64.eq(d[27],c.i64.cast([0,4]))?d[33]=!c.i64.eq(c.i64.and_(d[28],d[25]),c.i64.cast([0,0])):d[33]=!1,d[32]=d[33]),d[31]=d[32]),d[30]=d[31]),d[29]=d[30]),d[26]=d[29]),d[20]===d[26]?0:(function(a){c.logger(a).mustfix(a)}("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting"),c["throw"]("LS::assert is failed. Thread role and thread capability don't agree for Broadcast Channels message-as-page functionality; aborting")),d[18]=d[20]):d[18]=!1,d[16]=d[18])})},function(a){return d[8]=d[16]}]))})},function(a){return d[8]?d[7].set("perform_action_as_page",!0):0,d[10]=c.createArray(),d[11]=(d[10].push("reaction_v2"),d[10]),d[12]=d[7].get("message_id"),d[13]=(d[10].push(d[12]),d[10]),d[14]=c.toJSON(d[10]),d[15]=c.toJSON(d[7]),c.storedProcedure(b("LSIssueNewTaskWithExtraOperations"),d[14],c.i64.cast([0,604]),d[15],void 0,void 0,c.i64.cast([0,0]),c.i64.cast([0,0]),void 0,void 0,c.i64.cast([0,0]),void 0,c.i64.cast([0,0]))}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSMailboxOptimisticUpsertReactionV2StoredProcedure";a.__tables__=["threads","reactions","participants"];e.exports=a}),null);
__d("LSOptimisticUpsertReactionV2StoredProcedure",["LSOptimisticUpsertReactionV2","LSSynchronousPromise","Promise","cr:8709"],(function(a,b,c,d,e,f,g){var h;function a(a,e){a=a.storedProcedure(c("LSOptimisticUpsertReactionV2"),e.actorId,e.threadId,e.messageId,e.messageTimestamp,e.reactionFbid,e.currentCount,e.viewerIsReactor,e.reactionStyle,e.operation,e.reactionLiteral);return(h||(h=b("Promise"))).resolve(d("LSSynchronousPromise").maybeExtractValueIfSynchronousPromise(a))}g["default"]=a}),98);
__d("LSThreadAttributionStore",["I64"],(function(a,b,c,d,e,f,g){"use strict";var h,i=new Map();function a(a,b){var c;a=(c=(c=i.get(b))!=null?c:a)!=null?c:{type:"MWLSEntrypoint",value:"unknown"};i["delete"](b);return a}function b(a,b){a=(b=(b=i.get(b))!=null?b:a)!=null?b:{type:"MWLSEntrypoint",value:"unknown"};return a}function c(a,b){i.set(a,{type:"MWLSEntrypoint",value:b})}function e(a,b){b=(h||(h=d("I64"))).of_string(b);i.set(a,{type:"LSThreadAttribution",value:b})}function f(a){i.set("",{type:"MWLSEntrypoint",value:a})}function j(){var a=i.get("");if(a==null||a.type==="LSThreadAttribution")return"unknown";else return a.value}g.getSourceAndResetAttribution=a;g.getSourceWithoutReset=b;g.setSource=c;g.setLSMessagingThreadAttribution=e;g.setSourceForNewThread=f;g.getSourceForNewThread=j}),98);
__d("LSThreadAttributionTypeUtil",["I64","LSIntEnum","LSMessagingThreadAttributionType","LSThreadAttributionStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a,b){b=d("LSThreadAttributionStore").getSourceWithoutReset({type:"MWLSEntrypoint",value:b},(h||(h=d("I64"))).to_string(a));return j(b)}function b(a,b){b=d("LSThreadAttributionStore").getSourceAndResetAttribution({type:"MWLSEntrypoint",value:b},(h||(h=d("I64"))).to_string(a));return j(b)}function j(a){if(a.type==="LSThreadAttribution")return a.value;a=a.value;if(a==="inboxPendingRequests")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_PENDING_REQUESTS);else if(a==="fullscreenChat")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_COMMUNITY_MESSAGING_FULLSCREEN_CHAT);else if(a==="sidebarGroupsList")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").SIDEBAR_CONTACTS_GROUPS);else if(a==="jewel")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").JEWEL_THREAD_LIST);else if(a==="shop")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MINI_SHOP_VIEW_MENU_BUTTON);else if(a==="chatheadsOverflow")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").CHATHEADS_OVERFLOW);else if(a==="hovercard"||a==="feedDynamicHoverCard")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_DYNAMIC_HOVER_CARD);else if(a==="search"||a==="messengerUniversalSearch")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_UNIVERSAL_SEARCH);else if(a==="story"||a==="storyAggregatedUsers"||a==="storySeenByList")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_STORY);else if(a==="feedOrganicPost")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_ORGANIC_POST);else if(a==="timeline")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_PROFILE_MESSAGE_BUTTON);else if(a==="pageAboutCard")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_PAGE_ABOUT_CARD);else if(a==="inboxInThread")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_IN_THREAD);else if(a==="notificationInThreadReply")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_NOTIFICATION_IN_THREAD_REPLY);else if(a==="archieve")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_ARCHIVED_THREADS);else if(a==="storyViewerSheetRow")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_STORY_VIEWER_SHEET_ROW);else if(a==="chatheadsNewMessage")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").CHATHEADS_NEW_MESSAGE);else if(a==="event")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_EVENT);else if(a==="jewelSearch")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").JEWEL_SEARCH);else if(a==="inboxSpam"||a==="inboxThreadList"||a==="inboxRestricted")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX);else if(a==="jewelNewMessage")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").JEWEL_NEW_MESSAGE);else if(a==="pendingRequests")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_PENDING_REQUESTS_INBOX_THREAD_LIST);else if(a==="sidebarSearch")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").SIDEBAR_CONTACTS_SEARCH);else if(a==="inboxRemainingThreads")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_REMAINING_THREADS);else if(a==="pagesHeader")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_PAGE_PROFILE_HEADER_MESSAGE_BUTTON);else if(a==="inboxRecentThreads")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_RECENT_THREADS);else if(a==="chatheads")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").CHATHEADS);else if(a==="pageResponsivenessCard")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_PAGE_RESPONSIVENESS_CONTEXT_CARD);else if(a==="inboxSearch")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_MESSAGE_SEARCH);else if(a==="jewelNestedFolder")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").JEWEL_NESTED_FOLDER);else if(a==="marketplace")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MARKETPLACE_SEND_MESSAGE);else if(a==="feedOrganicPostViewAndMessage")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_ORGANIC_POST_VIEW_AND_MESSAGE);else if(a==="adsCta")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").CLICK_TO_MESSENGER_AD_SEND_MESSAGE_CTA);else if(a==="chatInThread")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_CHAT_IN_THREAD);else if(a==="payments")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").PAYMENTS);else if(a==="inboxFolder")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_NESTED_FOLDER);else if(a==="inboxArchived")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_ARCHIVED_THREADS);else if(a==="inboxActiveContacts")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_INBOX_ACTIVE_CONTACTS);else if(a==="sidebarContactsList")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").SIDEBAR_CONTACTS_LIST);else if(a==="sidebarCommunityChatsList")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").SIDEBAR_CONTACTS_COMMUNITY_CHATS);else if(a==="igdChatTabsThreadView")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").IGD_WEB_CHAT_TAB_IN_THREAD);else if(a==="inboxTrayActiveNow")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MONTAGE_AND_ACTIVE_NOW_ACTIVE_NOW);else if(a==="communityFriendsDialog")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_COMMUNITY_MESSAGING_COMMUNITY_FRIENDS_DIALOG);else if(a==="pagesHomeFriendsDialog")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_PAGE_PAGES_HOME_FRIENDS_DIALOG);else if(a==="mutualFriendsDialog")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_PROFILE_MUTUAL_FRIENDS_DIALOG);else if(a==="birthday")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_BIRTHDAY_CENTER);else if(a==="groupMembers")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_GROUPS_MEMBER_LIST);else if(a==="fundraiserSupportersList")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FUNDRAISER_SUPPORTERS_LIST);else if(a==="memories")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MEMORIES);else if(a==="feedPoll")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_FEED_POLL);else if(a==="reactorList")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_FEED_REACTORS_LIST_MESSAGE_BUTTON);else if(a==="friendsList")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FRIENDS_HOME);else if(a==="pagesPrivateReply")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").FB_PAGE_PAGES_PRIVATE_REPLY);else if(a==="inboxNewMessage")return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").MESSENGER_OMNIPICKER);else return(i||(i=d("LSIntEnum"))).ofNumber(c("LSMessagingThreadAttributionType").UNKNOWN)}g.getSourceWithoutReset=a;g.getSourceAndResetAttribution=b}),98);
__d("MAWEditMessageContext.react",["emptyFunction","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||(h=d("react"));b=h;e=b.createContext;var j=b.useMemo,k=b.useState;function a(a){a=a.children;var b=k(null),c=b[0],d=b[1];b=j(function(){return{editMessageData:c,setEditMessageData:d}},[c,d]);return i.jsx(l.Provider,{value:b,children:a})}a.displayName=a.name+" [from "+f.id+"]";var l=e({editMessageData:null,setEditMessageData:c("emptyFunction")});g.MAWEditMessageContext=a;g.Context=l}),98);
__d("MWChatFilePreProcessingErrorToast.react",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";a={body:h._(/*BTDS*/"The file you have selected is not a valid format."),title:h._(/*BTDS*/"_j[\"Invalid file format\",\"f90fb65f92ad8ac33f140b8be3c9eed1\",1]")};g.invalidFileFormat=a}),226);
__d("MWChatFileUploadErrorDialog.react",["fbt"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(a){return{body:h._(/*BTDS*/"The file you have selected is too large. The maximum size is {size}MB.",[h._param("size",a)]),title:h._(/*BTDS*/"Failed to upload files")}};b=function(a){return{body:h._(/*BTDS*/"You can only attach a maximum of {limit} files to a single message.",[h._param("limit",a)]),title:h._(/*BTDS*/"Unable to attach files")}};c=function(a){return{body:h._(/*BTDS*/"You can only attach a maximum of {limit} media to a single message.",[h._param("limit",a)]),title:h._(/*BTDS*/"Unable to attach media")}};d=function(){return{body:h._(/*BTDS*/"One or more selected files are not supported."),title:h._(/*BTDS*/"Unsupported File")}};g.maxFileSizeExceeded=a;g.maxFilesNumberExceeded=b;g.maxMediaNumberExceeded=c;g.unsupportedFile=d}),226);
__d("MWMediaComposerRenderQpl",["LSGetAttachmentType","MAWLoggerUtils","MWMediaRenderQplUtils","QPLUserFlow","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i=h||d("react"),j=i.useEffect,k=i.useMemo,l=i.useRef;function a(a,b,e){var f;a=d("MAWLoggerUtils").getInstanceKeyFromId(a);b=d("LSGetAttachmentType").LSGetAttachmentTypeSyncButLessAccurate(b);c("QPLUserFlow").start((f=d("MWMediaRenderQplUtils")).MSGR_WEB_MEDIA_RENDER_EVENT,{annotations:{string:{attachment_type:f.getAttachmentTypeStringFromEnum(b),content_type:f.deriveMessageContentTypeStringFromAttachmentTypeLessAccurate(b),entry_point:"composer_view",thread_type:f.getThreadTypeString(e)}},cancelOnUnload:!0,instanceKey:a,timeoutInMs:f.QPL_TIMEOUT})}function b(a,b){a=d("MAWLoggerUtils").getInstanceKeyFromId(a);c("QPLUserFlow").endCancel(d("MWMediaRenderQplUtils").MSGR_WEB_MEDIA_RENDER_EVENT,{annotations:{string:{cancel_reason:b}},instanceKey:a})}function e(a,b){a=d("MAWLoggerUtils").getInstanceKeyFromId(a);c("QPLUserFlow").addPoint(d("MWMediaRenderQplUtils").MSGR_WEB_MEDIA_RENDER_EVENT,b,{instanceKey:a})}function f(a){var b=d("MAWLoggerUtils").getInstanceKeyFromId(a.offlineAttachmentId),e=l(!1);c("QPLUserFlow").addAnnotations(d("MWMediaRenderQplUtils").MSGR_WEB_MEDIA_RENDER_EVENT,{string:{attachment_type:d("MWMediaRenderQplUtils").getAttachmentTypeStringFromEnum(a.attachmentType),content_type:d("MWMediaRenderQplUtils").deriveMessageContentTypeStringFromAttachmentTypeLessAccurate(a.attachmentType)}},{instanceKey:b});var f=k(function(){return babelHelpers["extends"]({},d("MWMediaRenderQplUtils").createQplFlowCommon(d("MWMediaRenderQplUtils").MSGR_WEB_MEDIA_RENDER_EVENT,b,e))},[]);j(function(){return function(){e.current===!1&&(f==null?void 0:f.getInstanceKey())!=null&&(f==null||f.endCancel(706))}},[f]);return f}g.startMediaComposerRenderQpl=a;g.endCancelMediaComposerRenderQpl=b;g.addPointMediaComposerRenderQpl=e;g.useMediaComposerRenderQpl=f}),98);
__d("MWSharedMediaManagerUtils",["GetPreviewDimension","I64","LSGetAttachmentType","LSIntEnum","LSMailboxType","MWPreloadableQueries","Promise","ReQLSuspense","asyncToGeneratorRuntime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k;function l(a,b){if(b==null||a==null)return;var c=Math.floor(a.previewHeight*b.previewWidth/a.previewWidth);return c>=b.previewHeight?{previewHeight:(k||(k=d("I64"))).of_float(c),previewWidth:k.of_float(b.previewWidth)}:{previewHeight:(k||(k=d("I64"))).of_float(b.previewHeight),previewWidth:k.of_float(a.previewWidth*b.previewHeight/a.previewHeight)}}function a(a,b,c){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d){var e=(yield o(c,d));yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield q(a,e));yield (i||(i=b("Promise"))).all(c.map(function(b){return a.media_staging.add(b)}))});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":79")});return m.apply(this,arguments)}function e(a,b,c){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c,d){var e=(yield o(c,d));yield a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var c=(yield q(a,e));yield (i||(i=b("Promise"))).all(c.map(function(){var c=b("asyncToGeneratorRuntime").asyncToGenerator(function*(c){(yield a.media_staging.get(c.offlineAttachmentId))!=null&&(yield a.media_staging.upsert([c.offlineAttachmentId],c));return(i||(i=b("Promise"))).resolve()});return function(a){return c.apply(this,arguments)}}()))});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":103")});return n.apply(this,arguments)}function o(a,b){return p.apply(this,arguments)}function p(){p=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,e){a=(yield (i||(i=b("Promise"))).all(a.map(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=a.file,f=a.offlineAttachmentId,g=a.attachmentType!=null?(j||(j=d("LSIntEnum"))).ofNumber(a.attachmentType):yield d("LSGetAttachmentType").LSGetAttachmentType(b),h=URL.createObjectURL(b),i;a.previewHeight!=null&&a.previewWidth!=null?i={previewHeight:a.previewHeight,previewWidth:a.previewWidth}:b.type.includes("video/")?i=(yield d("GetPreviewDimension").getVideoPreviewDimensions(h)):i=(yield d("GetPreviewDimension").getPreviewDimensions(h));g={attachmentType:g,durationMs:void 0,fbid:void 0,filename:b.name,fileSize:(k||(k=d("I64"))).of_int32(b.size),hasError:!1,isHd:a.isHd,isSent:!1,mailboxType:(j||(j=d("LSIntEnum"))).ofNumber(c("LSMailboxType").MESSENGER),mimeType:b.type,offlineAttachmentId:f,offlineThreadingId:void 0,previewUrl:h,progress:0,threadKey:e};return{dimensions:i,mediaStaging:g}});return function(b){return a.apply(this,arguments)}}())));return a});return p.apply(this,arguments)}function q(a,b){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){a=(yield a.sync_groups.get((k||(k=d("I64"))).of_float(1)));var c;if((a==null?void 0:a.syncParams)!=null){a=JSON.parse(a.syncParams);var e=a.preview_height;a=a.preview_width;c={previewHeight:e,previewWidth:a}}return b.map(function(a){var b=a.dimensions;a=a.mediaStaging;return babelHelpers["extends"]({},a,l(b,c))})});return r.apply(this,arguments)}function s(a,b){return a.runInTransaction(function(a){return a.media_staging["delete"](b)},"readwrite",void 0,void 0,f.id+":213")}function t(a){var b=(h||(h=c("useReStore")))();return d("ReQLSuspense").useArray(function(){return d("MWPreloadableQueries").getMediaStagingQuery(b,a.threadKey)},[b,a.threadKey],f.id+":223")}function u(a){if(a.mimeType==="image/gif")return!0;else return a.mimeType==="image/webp"}function v(a){return a.mimeType==="image/gif"}g.insertMediaStaging=a;g.updateMediaStaging=e;g.prepareMediaStagingFiles=o;g.deleteMediaStaging=s;g.useMediaStaging=t;g.isVideoLikeImage=u;g.isGIFImage=v}),98);
__d("WorkFailedSendMessageFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f,g){"use strict";a=c("getFalcoLogPolicy_DO_NOT_USE")("6352");b=d("FalcoLoggerInternal").create("work_failed_send_message",a);e=b;g["default"]=e}),98);
__d("useMWXAlertDialog",["react","useCometAlertDialog"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){var a=c("useCometAlertDialog")();return i(function(b,c,d){a(babelHelpers["extends"]({body:b.body},b),c,d)},[a])}g["default"]=a}),98);
__d("MWMediaManager",["FBLogger","I64","Int64Hooks","LSIntEnum","LSMessagingThreadTypeUtil","MWChatFilePreProcessingErrorToast.react","MWChatFileUploadErrorDialog.react","MWMediaComposerRenderQpl","MWPActor.react","MWPBumpEntityKey","MWSharedMediaManagerUtils","MessagingAttachmentType","OfflineThreadingId","Promise","WorkFailedSendMessageFalcoEvent","cr:8525","emptyFunction","gkx","promiseDone","requireDeferred","useMWXAlertDialog","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l=c("requireDeferred")("MWOpenMediaManagerUtils").__setRef("MWMediaManager"),m=function(){if(b("cr:8525")==null){c("FBLogger")("messenger_web_media").warn("Unsupported thread type for media upload");return(k||(k=b("Promise"))).resolve(null)}return b("cr:8525").load()},n=25;function o(a,c,d){if(c)return m().then(function(c){return(k||(k=b("Promise"))).resolve((c=c==null?void 0:c.preprocessV2(a,d))!=null?c:[])});else return l.load().then(function(b){return b.preprocess(a)})}function p(a,b,c){for(var e=0;e<a.length;e++){var f=a[e],g=c(f,b);if(f.size>g*1024*1024){f=q(f.size);d("MWPBumpEntityKey").bumpEntityKeyWithAppId("media_sends","file_size_exceeded."+(b?"secure":"open"));d("MWPBumpEntityKey").bumpEntityKeyWithAppId("media_sends","file_size_exceeded."+(b?"secure":"open")+"."+f);return g}}return null}function q(a){return a<=30*1024*1024?"30MB":a<=50*1024*1024?"50MB":a<=75*1024*1024?"75MB":a<=100*1024*1024?"100MB":a<=150*1024*1024?"150MB":a<=200*1024*1024?"200MB":a<=250*1024*1024?"250MB":a<=500*1024*1024?"500MB":a<=1024*1024*1024?"1GB":"1GB+"}function a(a){var e=a.chatSupportUserId,f=a.chatSupportUserNonce,g=a.getMaxAttachmentSizeInMB,q=g===void 0?function(){return n}:g,r=a.isChatSupportUser,s=a.maxNumberOfAttachments,t=a.onUploadFailure,u=a.onUploadStart,v=a.onUploadSuccess,w=a.showUploadFailureToast,x=a.thread,y=a.validateFileName,z=(j||(j=c("useReStore")))(),A=c("useMWXAlertDialog")(),B=d("LSMessagingThreadTypeUtil").isArmadilloSecure(x.threadType),C=d("MWSharedMediaManagerUtils").useMediaStaging(x),D=C.length,E=d("MWPActor.react").useActor();g=d("Int64Hooks").useCallbackInt64(function(a,g){var i=p(a,B,q);if(i!=null){A(d("MWChatFileUploadErrorDialog.react").maxFileSizeExceeded(i),c("emptyFunction"));return}if(s!=null&&D+a.length>s){c("gkx")("23249")?(A(d("MWChatFileUploadErrorDialog.react").maxFilesNumberExceeded(s),c("emptyFunction")),c("WorkFailedSendMessageFalcoEvent").log(function(){return{breaking_rule:"",event:"NUMBER_OF_ATTACHMENTS_LIMIT_REACHED"}})):A(d("MWChatFileUploadErrorDialog.react").maxMediaNumberExceeded(s),c("emptyFunction"));return}if(y!=null)for(i=0;i<a.length;i++){var j=a[i];if(!y(j)){A(d("MWChatFileUploadErrorDialog.react").unsupportedFile(),c("emptyFunction"));return}}var n=d("OfflineThreadingId").createForItemsInOrder(a);n.forEach(function(a){var b=a[0];a=a[1];d("MWMediaComposerRenderQpl").startMediaComposerRenderQpl(a,b,x);d("MWMediaComposerRenderQpl").addPointMediaComposerRenderQpl(a,"preprocess_start")});c("promiseDone")(o(n,B,g)["catch"](function(){w(d("MWChatFilePreProcessingErrorToast.react").invalidFileFormat.title,d("MWChatFilePreProcessingErrorToast.react").invalidFileFormat.body);n.forEach(function(a){a[0];a=a[1];d("MWMediaComposerRenderQpl").endCancelMediaComposerRenderQpl(a,"invalid-file-format")});return(k||(k=b("Promise"))).resolve([])}).then(function(a){a.forEach(function(a){d("MWMediaComposerRenderQpl").addPointMediaComposerRenderQpl(a.offlineAttachmentId,"preprocess_success")});var b=c("gkx")("16543"),g=null;b?g=d("MWSharedMediaManagerUtils").insertMediaStaging(z,a,x.threadKey):c("promiseDone")(d("MWSharedMediaManagerUtils").insertMediaStaging(z,a,x.threadKey));a.forEach(function(a){d("MWMediaComposerRenderQpl").addPointMediaComposerRenderQpl(a.offlineAttachmentId,"media_staging_insert_success")});var i=x.threadKey;if(B)return m().then(function(b){return b==null?void 0:b.upload(z,i,a)});if(b){return(b=g)==null?void 0:b.then(function(){return l.load().then(function(b){return b.upload(z,i,a,w,u,v,t,r,e,f,(h||(h=d("I64"))).to_string(E))})})}else return l.load().then(function(b){return b.upload(z,i,a,w,u,v,t,r,e,f,(h||(h=d("I64"))).to_string(E))})}))},[E,e,f,z,q,r,B,s,D,t,u,v,A,w,x,y]);a=function(a){c("promiseDone")(d("MWSharedMediaManagerUtils").deleteMediaStaging(z,a).then(function(){if(B&&b("cr:8525")!=null)return b("cr:8525").load().then(function(b){b.MAWMediaManagerAttachmentsV2["delete"](a)})}))};var F=function(){var a=C.map(function(a){return a.offlineAttachmentId});a.forEach(function(a){d("MWSharedMediaManagerUtils").deleteMediaStaging(z,a)["catch"](function(a){c("FBLogger")("messenger_web_media").catching(a).mustfix("Error deletting media staging.")})})},G=d("Int64Hooks").useCallbackInt64(function(a){if(!B)return;c("promiseDone")(m().then(function(e){if(e==null)return;var f=C.map(function(a){var b;if(!(h||(h=d("I64"))).equal(a.attachmentType,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingAttachmentType").IMAGE)))return null;b=(b=e.MAWMediaManagerAttachmentsV2.get(a.offlineAttachmentId))==null?void 0:b.originalFile;if(b==null)return null;b=[b,a.offlineAttachmentId];return b}).filter(Boolean);if(f.length===0)return;c("promiseDone")(o(f,B,a)["catch"](function(){w(d("MWChatFilePreProcessingErrorToast.react").invalidFileFormat.title,d("MWChatFilePreProcessingErrorToast.react").invalidFileFormat.body);f.forEach(function(a){a[0];a=a[1];d("MWMediaComposerRenderQpl").endCancelMediaComposerRenderQpl(a,"invalid-file-format")});return(k||(k=b("Promise"))).resolve([])}).then(function(a){a.forEach(function(a){d("MWMediaComposerRenderQpl").addPointMediaComposerRenderQpl(a.offlineAttachmentId,"preprocess_success")});c("promiseDone")(d("MWSharedMediaManagerUtils").updateMediaStaging(z,a,x.threadKey));a.forEach(function(a){d("MWMediaComposerRenderQpl").addPointMediaComposerRenderQpl(a.offlineAttachmentId,"media_staging_insert_success")});var b=x.threadKey;return e==null?void 0:e.upload(z,b,a)}))}))});return{handleFileRemove:a,handleFileSelect:g,mediaStaging:C,onHdMediaToggled:G,resetAttachments:F}}g.convertIntegerSizeToStringBucket=q;g.useMediaManager=a}),98);
__d("getFBTSafeGenderFromGenderConst",["GenderConst","IntlVariations"],(function(a,b,c,d,e,f,g){"use strict";function a(a){switch(a){case c("GenderConst").MALE_SINGULAR:return c("IntlVariations").GENDER_MALE;case c("GenderConst").FEMALE_SINGULAR:return c("IntlVariations").GENDER_FEMALE;default:return c("IntlVariations").GENDER_UNKNOWN}}g["default"]=a}),98);
__d("getMessengerPreciseTimestamp",["$InternalEnum","formatDate"],(function(a,b,c,d,e,f,g){"use strict";var h=b("$InternalEnum").Mirrored(["TODAY","WEEK_AGO","CURRENT_YEAR","OTHER_YEAR"]);d=864e5;var i=6*d;function j(a){a=new Date(a);var b=new Date();b=new Date(b.getFullYear(),b.getMonth(),b.getDate());if(b<a)return h.TODAY;if(b.getTime()-i<a.getTime())return h.WEEK_AGO;return b.getFullYear()===a.getFullYear()?h.CURRENT_YEAR:h.OTHER_YEAR}function k(a){a=j(a);switch(a){case h.TODAY:return"g:ia";case h.WEEK_AGO:return"l g:ia";case h.CURRENT_YEAR:return"F jS, g:ia";case h.OTHER_YEAR:return"F j, Y g:i a"}}function a(a,b){return c("formatDate")(new Date(a),k(a),void 0,b)}g["default"]=a}),98);
__d("MWMessageDeliveryStatus",["fbt","I64","LSIntEnum","getFBTSafeGenderFromGenderConst","getMessengerPreciseTimestamp","intlList","intlSummarizeNumber"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j;function a(a){if(a.length!==1)return{heads:a,type:"MultipleSeenHeads"};a=a[0];return{head:a,type:"SingleSeenHead"}}function b(a,b){return{delivered:b,heads:a,type:"DeliveredAndRead"}}function e(a){return{count:a,type:"SeenCount"}}function k(a){return a.timestamp>0?h._(/*BTDS*/"_j{\"*\":\"Seen by {full name} at {seen time}\"}",[h._name("full name",a.name,c("getFBTSafeGenderFromGenderConst")(a.gender)),h._param("seen time",c("getMessengerPreciseTimestamp")(a.timestamp))]):h._(/*BTDS*/"_j{\"*\":\"Seen by {full name}\"}",[h._name("full name",a.name,c("getFBTSafeGenderFromGenderConst")(a.gender))])}function l(a,b){if(a.length===0)return"";if(b)return h._(/*BTDS*/"Seen by everyone").toString();b=a.map(function(a){return h._(/*BTDS*/"_j{\"*\":\"{full name}\"}",[h._name("full name",a.name,c("getFBTSafeGenderFromGenderConst")(a.gender))])});a=c("intlList")(b,c("intlList").CONJUNCTIONS.AND,c("intlList").DELIMITERS.COMMA);return h._(/*BTDS*/"Seen by {full name}",[h._param("full name",a)]).toString()}function m(a){a=c("intlSummarizeNumber")(a);return h._(/*BTDS*/"Seen by {seen count}",[h._param("seen count",a)]).toString()}var n={delivered:h._(/*BTDS*/"Delivered"),error:h._(/*BTDS*/"Couldn't send"),loading:h._(/*BTDS*/"Loading..."),retriableError:h._(/*BTDS*/"Click to retry."),sending:h._(/*BTDS*/"Sending"),sent:h._(/*BTDS*/"Sent")};function f(a){switch(a.type){case"Sending":return n.sending;case"Sent":case"Delivered":return n.sent;case"Error":return n.error;case"SingleSeenHead":return k(a.head);case"NoneStatus":case"MultipleSeenHeads":return"";case"DeliveredAndRead":return l(a.heads,a.delivered);case"SeenCount":return m(a.count);case"Loading":return n.loading;case"RetriableError":return n.retriableError;case"ValidationError":return""}}function o(a){switch(a.type){case"Sending":return n.sending;case"Sent":return n.sent;case"Delivered":return n.delivered;case"Error":case"RetriableError":return n.error;case"SingleSeenHead":return k(a.head);case"DeliveredAndRead":return l(a.heads,a.delivered);default:return""}}function p(a){if((i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(1)))return{type:"Sending"};else if((i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(2))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(6)))return{type:"Sent"};else if((i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(4))||(i||(i=d("I64"))).equal(a,(j||(j=d("LSIntEnum"))).ofNumber(5)))return{type:"Error"};else return{type:"NoneStatus"}}function q(a,b,c){var e=p(a.sendStatusV2);if((i||(i=d("I64"))).equal(a.sendStatusV2,(j||(j=d("LSIntEnum"))).ofNumber(4))||(i||(i=d("I64"))).equal(a.sendStatusV2,(j||(j=d("LSIntEnum"))).ofNumber(5))||(i||(i=d("I64"))).equal(a.sendStatusV2,(j||(j=d("LSIntEnum"))).ofNumber(1)))return e;else if(!c&&(i||(i=d("I64"))).equal(a.sendStatusV2,(j||(j=d("LSIntEnum"))).ofNumber(2)))return{type:"NoneStatus"};else if((i||(i=d("I64"))).ge(b,a.timestampMs))return{type:"Delivered"};else return e}function r(a){return["SingleSeenHead","Sending","MultipleSeenHeads","Error","RetriableError"].includes(a.type)}g.seenHead=a;g.deliveredAndRead=b;g.seenCount=e;g.getSingleSeenHead=k;g.getSeenCount=m;g.Titles=n;g.getBroadcastStatusTitle=f;g.getStatusTitle=o;g.getFromSendStatus=p;g.getDeliveryStatusForMessageSentByYou=q;g.isAlwaysShownStatus=r}),226);
__d("ThreadStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({DEFAULT:0,PAUSED:1,PAUSED_AND_UPGRADED_TO_COMMUNITY:2,UPGRADED_TO_COMMUNITY_AND_TO_BE_PAUSED:3});f["default"]=a}),66);
__d("MWPThreadCapabilitiesContext",["I64","Int64Hooks","LSIntEnum","LSMessageThreadUnsendabilityStatus","LSThreadBitOffset","ThreadStatus","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k=h||(h=d("react"));e=h;var l=e.createContext,m=e.useContext,n=l({air131ShareChatMessagesWithMetaAiEnabled:!1,blurMediaEnabled:!1,canUnsendMessage:!1,communityMessagingChannelDescriptionCustomization:!1,communityMessagingChannelInvite:!1,disableLinks:!1,editMessageEnabled:!1,feedbackAndReportEnabled:!1,hasLSThreadBitOffset:function(a){return!1},isPaused:!1,localDeleteMessageEnabled:!1,messageForwardEnabled:!1,messageUnsendEnabled:!1,modifyPinnedMessageV2Enabled:!1,reactEnabled:!1,reactionsV2WriteEnabled:!1,replyEnabled:!1,reportMessageToAdminEnabled:!1,rtcVideoCallEnabled:!1,rtcVoiceCallEnabled:!1,seenCountV2Enabled:!1,subThreadCreationEnabled:!1});function a(a){var b=a.children,e=a.customCapabilityCheck,f=a.thread,g=f.capabilities,h=f.capabilities2,l=f.capabilities3,m=f.capabilities4,o=f.capabilities5,p=f.threadType,q=d("Int64Hooks").useCallbackInt64(function(a){var b={capabilities:g,capabilities2:h,capabilities3:l,capabilities4:m,capabilities5:o,threadType:p};return d("LSThreadBitOffset").has(a,b)},[g,h,l,m,o,p]);a=d("Int64Hooks").useMemoInt64(function(){return{air131ShareChatMessagesWithMetaAiEnabled:q(256),blurMediaEnabled:q(46),canUnsendMessage:f.cannotUnsendReason!=null?(i||(i=d("I64"))).equal(f.cannotUnsendReason,(j||(j=d("LSIntEnum"))).ofNumber(c("LSMessageThreadUnsendabilityStatus").CAN_UNSEND)):!0,communityMessagingChannelDescriptionCustomization:q(135),communityMessagingChannelInvite:q(120),disableLinks:q(45),editMessageEnabled:q(194),feedbackAndReportEnabled:q(17),hasLSThreadBitOffset:q!=null?q:e,isPaused:f.threadStatus!=null&&((i||(i=d("I64"))).equal(f.threadStatus,(i||(i=d("I64"))).of_int32(c("ThreadStatus").PAUSED))||(i||(i=d("I64"))).equal(f.threadStatus,(i||(i=d("I64"))).of_int32(c("ThreadStatus").PAUSED_AND_UPGRADED_TO_COMMUNITY))),localDeleteMessageEnabled:q(102),messageForwardEnabled:q(103),messageUnsendEnabled:q(122)&&f.cannotUnsendReason!=null?(i||(i=d("I64"))).equal(f.cannotUnsendReason,(j||(j=d("LSIntEnum"))).ofNumber(c("LSMessageThreadUnsendabilityStatus").CAN_UNSEND)):!1,modifyPinnedMessageV2Enabled:q(172),reactEnabled:q(18),reactionsV2WriteEnabled:q(169),replyEnabled:q(42),reportMessageToAdminEnabled:q(93),rtcVideoCallEnabled:q(24),rtcVoiceCallEnabled:q(25),seenCountV2Enabled:q(140),subThreadCreationEnabled:q(167)}},[e,q,f.threadStatus,f.cannotUnsendReason]);return k.jsx(n.Provider,{value:a,children:b})}a.displayName=a.name+" [from "+f.id+"]";function b(){return m(n)}g.Provider=a;g.useMWPThreadCapabilitiesContext=b}),98);
__d("MessageReactionOperation",[],(function(a,b,c,d,e,f){a=Object.freeze({ADD:1,REMOVE:2,REMOVE_MULTI_REACT:3});f["default"]=a}),66);
__d("MessageReactionStyle",[],(function(a,b,c,d,e,f){a=Object.freeze({NONE:0,BASIC_SUPER_REACT_ANIMATION:1,FB_EMOJI:2,FB_NON_DEFAULT_EMOJI:3});f["default"]=a}),66);
__d("MessagingCommunityType",[],(function(a,b,c,d,e,f){a=Object.freeze({FB_COMMUNITY:0,STANDALONE_COMMUNITY:1});f["default"]=a}),66);
__d("isDeliveryStatusErrorState",[],(function(a,b,c,d,e,f){"use strict";function a(a){return a.type==="Error"||a.type==="RetriableError"}f["default"]=a}),66);
__d("mwCMisStandAloneCommunity",["I64","LSIntEnum","MessagingCommunityType","vulture"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){c("vulture")("ngh07lUea_RXZmPFZs6V00Nd5wo=");return a==null?!1:(h||(h=d("I64"))).equal(a,(i||(i=d("LSIntEnum"))).ofNumber(c("MessagingCommunityType").STANDALONE_COMMUNITY))}g["default"]=a}),98);
__d("mwpMessageHasAttachment",["I64","LSIntEnum","justknobx"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function a(a){if(!(h||(h=d("I64"))).equal(a.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(1))&&c("justknobx")._("4768")&&!(h||(h=d("I64"))).equal(a.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(8192))&&!(h||(h=d("I64"))).equal(a.displayedContentTypes,(h||(h=d("I64"))).add((i||(i=d("LSIntEnum"))).ofNumber(1),(i||(i=d("LSIntEnum"))).ofNumber(8192)))&&!(h||(h=d("I64"))).equal(a.displayedContentTypes,(i||(i=d("LSIntEnum"))).ofNumber(128))&&!(h||(h=d("I64"))).equal(a.displayedContentTypes,(h||(h=d("I64"))).add((i||(i=d("LSIntEnum"))).ofNumber(128),(i||(i=d("LSIntEnum"))).ofNumber(8192))))return!(h||(h=d("I64"))).equal(a.displayedContentTypes,h.add((i||(i=d("LSIntEnum"))).ofNumber(1),i.ofNumber(512)));else return!1}g["default"]=a}),98);
__d("useContactReachabilityStatus",["I64","Int64Hooks","LSContactBitOffset","LSMessagingThreadTypeUtil","MWPActor.react","ReQL","ReQLSuspense","react-compiler-runtime","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a,b){var c=d("react-compiler-runtime").c(7),e=d("MWPActor.react").useActor(),f=k(a,b);c[0]!==e||c[1]!==f[0]||c[2]!==f.length?(a=function(){if(f.length===1){var a=f[0];a=a[1].id;return(i||(i=d("I64"))).equal(e,a)}return!1},c[0]=e,c[1]=f[0],c[2]=f.length,c[3]=a):a=c[3];c[4]!==e||c[5]!==f?(b=[e,f],c[4]=e,c[5]=f,c[6]=b):b=c[6];c=d("Int64Hooks").useMemoInt64(a,b);return c}function k(a,b){var c=d("react-compiler-runtime").c(7),e;c[0]!==a.tables.contacts||c[1]!==a.tables.participants||c[2]!==b?(e=function(){return d("ReQL").mergeJoin(d("ReQL").fromTableAscending(a.tables.participants,[]).getKeyRange(b),d("ReQL").fromTableAscending(a.tables.contacts,["id","name","secondaryName","blockedByViewerStatus"].concat(d("LSContactBitOffset").contactCapabilityFields,["blockedSinceTimestampMs","contactTypeExact","contactReachabilityStatusType"])))},c[0]=a.tables.contacts,c[1]=a.tables.participants,c[2]=b,c[3]=e):e=c[3];var g;c[4]!==a||c[5]!==b?(g=[a,b],c[4]=a,c[5]=b,c[6]=g):g=c[6];c=d("ReQLSuspense").useArray(e,g,f.id+":51");return c}function l(a,b,c){var e=d("react-compiler-runtime").c(6),f=k(a,b),g=j(a,b),h=d("MWPActor.react").useActor();e[0]!==h||e[1]!==g||e[2]!==f||e[3]!==c?(a=function(){if(!d("LSMessagingThreadTypeUtil").isOneToOne(c))return;if(f.length===1){var a=f[0];if(g)return a}return f.find(function(a){a=a[1];return!(i||(i=d("I64"))).equal(a.id,h)})},b=[h,g,f,c],e[0]=h,e[1]=g,e[2]=f,e[3]=c,e[4]=a,e[5]=b):(a=e[4],b=e[5]);e=d("Int64Hooks").useMemoInt64(a,b);return e}function a(a,b){var d=(h||(h=c("useReStore")))();d=l(d,a,b);return d==null?void 0:d[1].contactReachabilityStatusType}g.useIsSelfThread=j;g.useParticipantsAndContacts=k;g.useOtherUser=l;g.useContactReachabilityStatus=a}),98);
__d("useIGDOptimisticReactMessage",["I64","LSAuthorityLevel","MAWTimeUtils","WATimeUtils","asyncToGeneratorRuntime","err","react"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=(h||d("react")).useCallback;function a(){return j(function(a,e,g,h,j){return a.runInTransaction(function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){try{if(j==null){var b=(yield a.reactions.get(e,g,h));yield a.reactions["delete"](e,g,h);return{removedReaction:b}}else{b={actorId:h,authorityLevel:(i||(i=d("I64"))).of_int32(c("LSAuthorityLevel").OPTIMISTIC),messageId:g,reaction:j!=null?j:"",threadKey:e,timestampMs:d("MAWTimeUtils").toTimestamp(d("WATimeUtils").unixTime()),transportKey:"Instamadillo"};yield a.reactions.upsert([e,g,h],b);return{addedReaction:b}}}catch(a){throw c("err")("Instamadillo: Failed to send or unsend optimistic reaction: "+a+" ")}});return function(b){return a.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":39")},[])}g["default"]=a}),98);
__d("useIsChatPreviewsEnabled",["MWLSThread","ReQL","ReQLSuspense","isUnjoinedCMThread","mwCMisStandAloneCommunity","qex","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=(h||(h=c("useReStore")))(),e=d("MWLSThread").useThread(a,function(a){return a.parentThreadKey}),g=d("ReQLSuspense").useFirst(function(){return e!=null?d("ReQL").fromTableAscending(b.tables.community_folders).getKeyRange(e):d("ReQL").empty()},[b,e],f.id+":28");return(a=d("MWLSThread").useThread(a,function(a){return i(a,g==null?void 0:g.communityType)}))!=null?a:!1}function i(a,b){if(a.needsAdminApprovalForNewParticipant===!0)return!1;return!d("isUnjoinedCMThread").isUnjoinedCMThread(a.threadType)?!1:c("mwCMisStandAloneCommunity")(b)&&!c("qex")._("1827")}g.useIsChatPreviewsEnabled=a;g.isChatPreviewsEnabled=i}),98);
__d("useIsMultiReactionEnabled",["LSMessagingThreadTypeUtil","LSThreadBitOffset","MWLSThread","ReQL","ReQLSuspense","isUnjoinedCMThread","mwCMIsAnyCMThread","useIsChatPreviewsEnabled","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=(h||(h=c("useReStore")))(),e=d("MWLSThread").useThread(a,function(a){return a.parentThreadKey}),g=d("ReQLSuspense").useFirst(function(){return e!=null?d("ReQL").fromTableAscending(b.tables.community_folders).getKeyRange(e):d("ReQL").empty()},[b,e],f.id+":28");return(a=d("MWLSThread").useThread(a,function(a){if(d("isUnjoinedCMThread").isUnjoinedCMThread(a.threadType))return d("useIsChatPreviewsEnabled").isChatPreviewsEnabled(a,g==null?void 0:g.communityType);if(!d("LSThreadBitOffset").has(156,a))return!1;if(c("mwCMIsAnyCMThread")(a.threadType))return!0;if(d("LSMessagingThreadTypeUtil").isDiscoverableChannel(a.threadType))return!0}))!=null?a:!1}g.useIsMultiReactEnabled=a}),98);
__d("useIsReactionsV2Enabled",["LSMessagingThreadTypeUtil","LSThreadBitOffset","MWCMThreadTypes.react","MWLSThread","ReQL","ReQLSuspense","useIsChatPreviewsEnabled","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){var b=(h||(h=c("useReStore")))(),e=d("MWLSThread").useThread(a,function(a){return a.parentThreadKey}),g=d("ReQLSuspense").useFirst(function(){return e!=null?d("ReQL").fromTableAscending(b.tables.community_folders).getKeyRange(e):d("ReQL").empty()},[b,e],f.id+":34");return(a=d("MWLSThread").useThread(a,function(a){return i(a,g==null?void 0:g.communityType)}))!=null?a:!1}function i(a,b){if(d("LSMessagingThreadTypeUtil").isOpenFnFThread(a)&&!d("MWCMThreadTypes.react").isIGBroadcastChannelThread(a.threadSubtype))return!1;if(d("LSThreadBitOffset").has(139,a))return!0;a=d("useIsChatPreviewsEnabled").isChatPreviewsEnabled(a,b);return a?!0:!1}function b(a,b){var c=d("LSMessagingThreadTypeUtil").isUnjoinedDiscoverablePublicBroadcastChannel(a.threadType)||d("LSMessagingThreadTypeUtil").isSocialChannelUnjoined(a.threadType);a=d("useIsChatPreviewsEnabled").isChatPreviewsEnabled(a,b);return c||a}g.useIsReactionsV2Enabled=a;g.isReactionsV2Enabled=i;g.isReactionsV2ReadOnly=b}),98);
__d("useLSMessagingSource",["IGDWebUtils","MWLSThreadDisplayContext"],(function(a,b,c,d,e,f,g){"use strict";function a(){var a=d("MWLSThreadDisplayContext").useMWLSThreadDisplayContext(),b=d("IGDWebUtils").isOnInstagramWeb();switch(a){case"Inbox":return"inboxInThread";case"FullscreenChat":return"fullscreenChat";case"ChatTab":return b?"igdChatTabsThreadView":"chatInThread";default:return"unknown"}}g["default"]=a}),98);
__d("useMWLSDefaultThreadSourceAndResetAttribution",["LSThreadAttributionTypeUtil","react","useLSMessagingSource"],(function(a,b,c,d,e,f,g){"use strict";var h,i=(h||d("react")).useCallback;function a(){var a=c("useLSMessagingSource")();return i(function(b){return d("LSThreadAttributionTypeUtil").getSourceAndResetAttribution(b,a)},[a])}g["default"]=a}),98);
__d("useMWPSendOrUnsendReaction",["FBLogger","I64","Int64Hooks","LSFactory","LSIntEnum","LSOptimisticUpsertReactionStoredProcedure","LSOptimisticUpsertReactionV2StoredProcedure","MWPActor.react","MessageReactionOperation","MessageReactionStyle","ReQL","asyncToGeneratorRuntime","promiseDone","useIsMultiReactionEnabled","useIsReactionsV2Enabled","useMWLSDefaultThreadSourceAndResetAttribution","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j;function k(a,b,e,g,h,j){c("promiseDone")(a.runInTransaction(function(a){return c("LSOptimisticUpsertReactionV2StoredProcedure")(c("LSFactory")(a),{actorId:b,currentCount:h,messageId:e.messageId,messageTimestamp:e.timestampMs,operation:(i||(i=d("LSIntEnum"))).ofNumber(c("MessageReactionOperation").ADD),reactionFbid:g,reactionLiteral:j,reactionStyle:i.ofNumber(c("MessageReactionStyle").BASIC_SUPER_REACT_ANIMATION),threadId:e.threadKey,viewerIsReactor:!0})},"readwrite",void 0,void 0,f.id+":42"))}function l(a,b,c,d,e,f,g){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e,g,h,j,k){yield a.runInTransaction(function(a){return c("LSOptimisticUpsertReactionV2StoredProcedure")(c("LSFactory")(a),{actorId:b,currentCount:g,messageId:e.messageId,messageTimestamp:e.timestampMs,operation:(i||(i=d("LSIntEnum"))).ofNumber(k?c("MessageReactionOperation").REMOVE_MULTI_REACT:c("MessageReactionOperation").REMOVE),reactionFbid:h,reactionLiteral:j,reactionStyle:i.ofNumber(c("MessageReactionStyle").BASIC_SUPER_REACT_ANIMATION),threadId:e.threadKey,viewerIsReactor:!1})},"readwrite",void 0,void 0,f.id+":72")});return m.apply(this,arguments)}function n(a,b,e,f,g){c("promiseDone")(d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.reactions_v2).getKeyRange(e.threadKey,e.messageId,f)).then(function(c){c!=null?k(a,b,e,f,c.count,g):k(a,b,e,f,(j||(j=d("I64"))).zero,g)}))}function a(a){var e=(h||(h=c("useReStore")))(),g=d("MWPActor.react").useActor(),i=c("useMWLSDefaultThreadSourceAndResetAttribution")(),k=d("useIsMultiReactionEnabled").useIsMultiReactEnabled(a.threadKey);return d("Int64Hooks").useCallbackInt64(function(h){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.threads).getKeyRange(a.threadKey)));b=b?d("useIsReactionsV2Enabled").isReactionsV2Enabled(b):!1;if(b){var m=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.reaction_v2_types).filter(function(a){return a.reactionLiteral===h||a.reactionLiteralVariant16===h})));if(m!=null){b=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(e.tables.reactions_v2).getKeyRange(a.threadKey,a.messageId).filter(function(a){return(!k||(j||(j=d("I64"))).equal(a.reactionFbid,m.reactionFbid))&&a.viewerIsReactor})));if(b==null)return n(e,g,a,m.reactionFbid,h);var o=(j||(j=d("I64"))).equal(b.reactionFbid,m.reactionFbid);(!k||o)&&(yield l(e,g,a,b.count,b.reactionFbid,h,k));o||(yield n(e,g,a,m.reactionFbid,h))}else c("FBLogger")("messenger_web").warn("Reactions v2: trying to send reaction that is not in reaction_v2_types table");return}return e.runInTransaction(function(b){return c("LSOptimisticUpsertReactionStoredProcedure")(c("LSFactory")(b),{actorId:g,messageId:a.messageId,reaction:h,sendAttribution:i(a.threadKey),threadKey:a.threadKey,timestampMs:(j||(j=d("I64"))).of_float(Date.now())})},"readwrite",void 0,void 0,f.id+":227")})())},[e,a,k,g,i])}g["default"]=a}),98);
__d("useIGDGlobalReactMessage",["FBLogger","I64","IGDBridgedAPI","Int64Hooks","LSAuthorityLevel","MWPActor.react","ReQL","ReQLSuspense","asyncToGeneratorRuntime","promiseDone","react-compiler-runtime","requireDeferred","useIGDOptimisticReactMessage","useMWPSendOrUnsendReaction","useReStore"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j=c("requireDeferred")("MWLogMessageAction").__setRef("useIGDGlobalReactMessage");function a(a,e){var g=d("react-compiler-runtime").c(18),h=(i||(i=c("useReStore")))(),l=d("MWPActor.react").useActor(),m=a.transportKey==="Instamadillo",n=c("useIGDOptimisticReactMessage")(),o;g[0]!==h.tables.e2ee_igMessageAuxiliaryInfo||g[1]!==a.messageId?(o=function(){return d("ReQL").fromTableAscending(h.tables.e2ee_igMessageAuxiliaryInfo).getKeyRange(a.messageId)},g[0]=h.tables.e2ee_igMessageAuxiliaryInfo,g[1]=a.messageId,g[2]=o):o=g[2];var p;g[3]!==h||g[4]!==a.messageId?(p=[h,a.messageId],g[3]=h,g[4]=a.messageId,g[5]=p):p=g[5];o=d("ReQLSuspense").useFirst(o,p,f.id+":51");var q=Boolean(o==null?void 0:o.openEb),r=c("useMWPSendOrUnsendReaction")(a);g[6]!==l||g[7]!==n||g[8]!==h||g[9]!==m||g[10]!==q||g[11]!==a.messageId||g[12]!==a.senderId||g[13]!==a.threadKey||g[14]!==r||g[15]!==e?(p=function(){return function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(d,f){if(m||q){var g=(yield n(h,a.threadKey,a.messageId,l,d)),i=g.removedReaction;g={messageId:a.messageId,reaction:i!=null?i.reaction:d,reactionStatus:i!=null?"deleted":"created",threadKey:a.threadKey};c("promiseDone")(c("IGDBridgedAPI").sendOrRemoveReaction(g)["catch"](function(){var d=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){yield k(h,a.threadKey,a.messageId,l,i);throw c("FBLogger")("igd_web").catching(b).warn("Instamadillo: Failed to send or unsend reaction: %s.",b)});return function(a){return d.apply(this,arguments)}}()))}else r(d!=null?d:"");j.onReady(function(b){return c("promiseDone")(b.log(h,a.messageId,a.threadKey,e,f,void 0,void 0,void 0,a.senderId,void 0,l))})});return function(a,b){return d.apply(this,arguments)}}()},o=[m,q,n,a.threadKey,a.messageId,a.senderId,h,l,r,e],g[6]=l,g[7]=n,g[8]=h,g[9]=m,g[10]=q,g[11]=a.messageId,g[12]=a.senderId,g[13]=a.threadKey,g[14]=r,g[15]=e,g[16]=p,g[17]=o):(p=g[16],o=g[17]);return d("Int64Hooks").useMemoInt64(p,o)}function k(a,e,g,i,j){return a.runInTransaction(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){if(j!=null)return b.reactions.upsert([j.threadKey,j.messageId,j.actorId],babelHelpers["extends"]({},j));else{var f=(yield d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.tables.reactions).getKeyRange(e,g,i).filter(function(a){return(h||(h=d("I64"))).equal(a.authorityLevel,h.of_int32(c("LSAuthorityLevel").OPTIMISTIC))})));if(f!=null)return b.reactions["delete"](f.threadKey,f.messageId,f.actorId)}});return function(a){return f.apply(this,arguments)}}(),"readwrite",void 0,void 0,f.id+":147")}g["default"]=a}),98);
__d("useIGDMediaMangerUploadFailedToast",["fbt","IGDSErrorOutlineIcon.react","react","react-compiler-runtime","useIGDSToaster"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=i||(i=d("react"));i.useCallback;function a(){var a=d("react-compiler-runtime").c(2),b=c("useIGDSToaster")(),e;a[0]!==b?(e=function(a,d){b.add({icon:j.jsx(c("IGDSErrorOutlineIcon.react"),{alt:h._(/*BTDS*/"Error icon")}),message:a,messageSecondary:d,target:"bottom-left"},{duration:2750})},a[0]=b,a[1]=e):e=a[1];return e}g["default"]=a}),226);